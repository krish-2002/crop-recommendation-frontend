<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Crop Recommendation System</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1B4332;  /* Deep forest green */
            --secondary-color: #2D6A4F;  /* Rich green */
            --accent-color: #FFB703;  /* Bright amber */
            --text-color: #FFFFFF;  /* Pure white */
            --dark-green: #081C15;  /* Darkest green */
            --light-green: #74C69D;  /* Mint green */
            --earth-brown: #6A4C93;  /* Purple accent */
            --cream: #FFF8E1;  /* Soft cream */
            --card-bg: rgba(27, 67, 50, 0.85);  /* Semi-transparent green */
            --card-hover: rgba(27, 67, 50, 0.95);  /* Darker on hover */
            --success-color: #40916C;  /* Success green */
            --error-color: #E63946;  /* Error red */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @keyframes grain {
            0%, 100% { transform: translate(0, 0) }
            10% { transform: translate(-5%, -5%) }
            20% { transform: translate(-10%, 5%) }
            30% { transform: translate(5%, -10%) }
            40% { transform: translate(-5%, 15%) }
            50% { transform: translate(-10%, 5%) }
            60% { transform: translate(15%, 0) }
            70% { transform: translate(0, 10%) }
            80% { transform: translate(-15%, 0) }
            90% { transform: translate(10%, 5%) }
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--dark-green), var(--primary-color));
            min-height: 100vh;
            padding: 20px;
            position: relative;
            color: var(--text-color);
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M30,50c0,0,10-20,40,0c-30,20-40,0-40,0z" fill="none" stroke="%234a7c59" stroke-width="1"/></svg>') 0 0/50px 50px,
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20,80c0,0,20-40,60,0" fill="none" stroke="%23345e41" stroke-width="1"/></svg>') 25px 25px/50px 50px;
            opacity: 0.1;
            z-index: -1;
            animation: grain 8s steps(10) infinite;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(243, 185, 95, 0.1) 0%, transparent 60%);
            animation: rotate 15s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            color: var(--text-color);
            font-size: 2.8em;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            position: relative;
            z-index: 1;
        }

        .card {
            background: linear-gradient(
                rgba(27, 67, 50, 0.85), 
                rgba(45, 106, 79, 0.9)
            );
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            animation: slowZoom 20s infinite ease-in-out;
            background-size: 120% 120%;
        }

        .card:nth-child(2) {
            background: linear-gradient(
                rgba(44, 74, 59, 0.85), 
                rgba(44, 74, 59, 0.9)
            ),
            url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wxMjA3fDB8MXxhbGx8fHx8fHx8fHwxNjk4MjMwNDc5fA&ixlib=rb-4.0.3&q=80&w=1080') center/cover;
            animation-delay: 10s;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 183, 3, 0.2),
                transparent
            );
            transition: 0.5s;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }

        .card:hover::before {
            left: 100%;
        }

        h2 {
            color: var(--accent-color);
            margin-bottom: 25px;
            font-size: 1.8em;
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 10px;
            position: relative;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .sensor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .sensor-card {
            background: linear-gradient(135deg, rgba(27, 67, 50, 0.8), rgba(45, 106, 79, 0.9));
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes growPlant {
            0% { transform: scaleY(0); opacity: 0; }
            100% { transform: scaleY(1); opacity: 1; }
        }

        .sensor-card::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 60%;
            background: var(--accent-color);
            animation: growPlant 1.5s ease-out forwards;
        }

        .sensor-card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .sensor-value {
            font-size: 2em;
            font-weight: 600;
            color: var(--accent-color);
            margin: 10px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .sensor-label {
            color: var(--text-color);
            font-size: 1em;
            font-weight: 500;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .form-group {
            background: linear-gradient(135deg, rgba(27, 67, 50, 0.6), rgba(45, 106, 79, 0.7));
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: var(--text-color);
            font-weight: 500;
            font-size: 1.1em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        select {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, rgba(27, 67, 50, 0.8), rgba(45, 106, 79, 0.9));
            color: var(--text-color);
            cursor: pointer;
        }

        select:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(255, 183, 3, 0.2);
        }

        select option {
            background-color: var(--dark-green);
            color: var(--text-color);
        }

        .btn {
            background: linear-gradient(45deg, var(--accent-color), #FFD60A);
            color: var(--dark-green);
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 600;
            width: 100%;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.4),
                transparent
            );
            transition: 0.5s;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 183, 3, 0.4);
        }

        .btn:hover::before {
            left: 100%;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 30px 0;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 183, 3, 0.2);
            border-top: 5px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #result {
            margin-top: 30px;
            padding: 25px;
            border-radius: 15px;
            display: none;
            animation: fadeIn 0.6s ease;
            background: rgba(64, 145, 108, 0.9);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .success {
            background: linear-gradient(45deg, var(--success-color), #40916C);
            color: var(--text-color);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .error {
            background: linear-gradient(45deg, var(--error-color), #E63946);
            color: var(--text-color);
        }

        .crop-result {
            text-align: center;
            padding: 25px;
        }

        .crop-result h3 {
            color: var(--accent-color);
            font-size: 2.2em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .confidence {
            font-size: 1.3em;
            color: var(--text-color);
            margin: 15px 0;
        }

        .confidence-bar {
            width: 100%;
            height: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            margin: 15px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--accent-color), #FFD60A);
            transition: width 1.5s ease;
            position: relative;
        }

        .confidence-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        #systemStatus {
            display: flex;
            align-items: center;
            padding: 15px;
            background: linear-gradient(135deg, rgba(27, 67, 50, 0.8), rgba(45, 106, 79, 0.9));
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .status-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 10px;
            animation: pulse 2s infinite;
            box-shadow: 0 0 0 0 rgba(255, 183, 3, 0.4);
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; box-shadow: 0 0 0 0 rgba(255, 183, 3, 0.4); }
            50% { transform: scale(1.2); opacity: 0.7; box-shadow: 0 0 0 10px rgba(255, 183, 3, 0); }
            100% { transform: scale(1); opacity: 1; box-shadow: 0 0 0 0 rgba(255, 183, 3, 0); }
        }

        #statusText {
            font-size: 1.1em;
            font-weight: 500;
            color: var(--text-color);
        }

        /* Plant growth animation for decorative elements */
        @keyframes sway {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .plant-decoration {
            position: absolute;
            bottom: -10px;
            width: 30px;
            height: 60px;
            opacity: 0.2;
        }

        .plant-decoration::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 2px;
            height: 100%;
            background: var(--accent-color);
            transform-origin: bottom;
            animation: sway 4s ease-in-out infinite;
        }

        .plant-decoration::after {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: 
                radial-gradient(
                    circle at center,
                    var(--accent-color) 0%,
                    transparent 60%
                );
        }

        .card .plant-decoration:nth-child(1) { left: 10%; animation-delay: 0s; }
        .card .plant-decoration:nth-child(2) { left: 30%; animation-delay: 0.5s; }
        .card .plant-decoration:nth-child(3) { right: 30%; animation-delay: 1s; }
        .card .plant-decoration:nth-child(4) { right: 10%; animation-delay: 1.5s; }

        /* Add a subtle animation to the backgrounds */
        @keyframes slowZoom {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .card {
            animation: slowZoom 20s infinite ease-in-out;
            background-size: 120% 120%;
        }

        .card:nth-child(2) {
            animation-delay: 10s;
        }

        /* Enhance text readability */
        h2, label, .sensor-value, .sensor-label {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Add a natural grain overlay */
        .card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23noise)" opacity="0.075"/></svg>');
            opacity: 0.1;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Smart Crop Recommendation System</h1>
        <p>Get AI-powered crop recommendations based on real-time sensor data</p>
    </div>

    <div class="container">
        <div class="card">
            <div class="plant-decoration"></div>
            <div class="plant-decoration"></div>
            <div class="plant-decoration"></div>
            <div class="plant-decoration"></div>
            <h2>System Status</h2>
            <div id="systemStatus">
                <span class="status-indicator" id="statusDot"></span>
                <span id="statusText">Checking system status...</span>
            </div>
            <div class="sensor-grid" id="sensorData">
                <!-- Sensor data will be populated here -->
            </div>
        </div>

        <div class="card">
            <div class="plant-decoration"></div>
            <div class="plant-decoration"></div>
            <div class="plant-decoration"></div>
            <div class="plant-decoration"></div>
            <h2>Enter Farm Details</h2>
            <div class="form-group">
                <label for="soil_type">Soil Type:</label>
                <select id="soil_type" required>
                    <option value="">Select Soil Type</option>
                    <option value="alluvial">Alluvial</option>
                    <option value="black">Black</option>
                    <option value="red">Red</option>
                    <option value="laterite">Laterite</option>
                    <option value="mountain">Mountain</option>
                    <option value="desert">Desert</option>
                    <option value="saline">Saline</option>
                    <option value="peaty">Peaty</option>
                </select>
            </div>
            <div class="form-group">
                <label for="weather">Weather Condition:</label>
                <select id="weather" required>
                    <option value="">Select Weather</option>
                    <option value="sunny">Sunny</option>
                    <option value="rainy">Rainy</option>
                    <option value="cloudy">Cloudy</option>
                    <option value="partly_cloudy">Partly Cloudy</option>
                    <option value="humid">Humid</option>
                    <option value="dry">Dry</option>
                </select>
            </div>
            <div class="form-group">
                <label for="region">State:</label>
                <select id="region" required>
                    <option value="">Select State</option>
                    <option value="andhra_pradesh">Andhra Pradesh</option>
                    <option value="arunachal_pradesh">Arunachal Pradesh</option>
                    <option value="assam">Assam</option>
                    <option value="bihar">Bihar</option>
                    <option value="chhattisgarh">Chhattisgarh</option>
                    <option value="gujarat">Gujarat</option>
                    <option value="haryana">Haryana</option>
                    <option value="himachal_pradesh">Himachal Pradesh</option>
                    <option value="jharkhand">Jharkhand</option>
                    <option value="karnataka">Karnataka</option>
                    <option value="kerala">Kerala</option>
                    <option value="madhya_pradesh">Madhya Pradesh</option>
                    <option value="maharashtra">Maharashtra</option>
                    <option value="manipur">Manipur</option>
                    <option value="meghalaya">Meghalaya</option>
                    <option value="mizoram">Mizoram</option>
                    <option value="nagaland">Nagaland</option>
                    <option value="odisha">Odisha</option>
                    <option value="punjab">Punjab</option>
                    <option value="rajasthan">Rajasthan</option>
                    <option value="sikkim">Sikkim</option>
                    <option value="tamil_nadu">Tamil Nadu</option>
                    <option value="telangana">Telangana</option>
                    <option value="tripura">Tripura</option>
                    <option value="uttar_pradesh">Uttar Pradesh</option>
                    <option value="uttarakhand">Uttarakhand</option>
                    <option value="west_bengal">West Bengal</option>
                </select>
            </div>
            <button onclick="getPrediction()" id="predictBtn" class="btn">Get Crop Recommendation</button>
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <p>Analyzing conditions and predicting best crop...</p>
            </div>
            <div id="result"></div>
        </div>
    </div>

    <script>
        // API endpoint configuration
        const API_BASE_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:5001'
            : 'https://farmwise-2noy.onrender.com';  // Updated Render backend URL

        // Function to update system status
        async function updateSystemStatus() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/system-status`);
                const data = await response.json();
                
                const statusDot = document.getElementById('statusDot');
                const statusText = document.getElementById('statusText');
                
                statusDot.className = 'status-indicator status-' + data.status;
                statusText.textContent = data.message;

                // Update sensor data
                const sensorData = document.getElementById('sensorData');
                sensorData.innerHTML = `
                    <div class="sensor-card">
                        <div class="sensor-value">${data.sensor_status.temperature}Â°C</div>
                        <div class="sensor-label">Temperature</div>
                    </div>
                    <div class="sensor-card">
                        <div class="sensor-value">${data.sensor_status.humidity}%</div>
                        <div class="sensor-label">Humidity</div>
                    </div>
                    <div class="sensor-card">
                        <div class="sensor-value">${data.sensor_status.moisture}</div>
                        <div class="sensor-label">Soil Moisture</div>
                    </div>
                    <div class="sensor-card">
                        <div class="sensor-value">${data.sensor_status.ph}</div>
                        <div class="sensor-label">pH Level</div>
                    </div>
                `;
            } catch (error) {
                console.error('Error fetching system status:', error);
            }
        }

        // Function to get prediction
        async function getPrediction() {
            const soilType = document.getElementById('soil_type').value;
            const weather = document.getElementById('weather').value;
            const region = document.getElementById('region').value;

            if (!soilType || !weather || !region) {
                showResult('Please fill in all fields', 'error');
                return;
            }

            const predictBtn = document.getElementById('predictBtn');
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');

            try {
                predictBtn.disabled = true;
                loading.style.display = 'block';
                result.style.display = 'none';

                const response = await fetch(`${API_BASE_URL}/api/predict`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        soil_type: soilType,
                        weather: weather,
                        region: region
                    })
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();
                showResult(`
                    <div class="crop-result">
                        <h3>${data.crop}</h3>
                        <div class="confidence">
                            Confidence: ${(data.confidence * 100).toFixed(1)}%
                        </div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: ${data.confidence * 100}%"></div>
                        </div>
                    </div>
                `, 'success');
            } catch (error) {
                showResult('Error: ' + error.message, 'error');
            } finally {
                predictBtn.disabled = false;
                loading.style.display = 'none';
            }
        }

        function showResult(message, type) {
            const result = document.getElementById('result');
            result.innerHTML = message;
            result.className = type;
            result.style.display = 'block';
        }

        // Update system status every 30 seconds
        updateSystemStatus();
        setInterval(updateSystemStatus, 30000);
    </script>
</body>
</html>
